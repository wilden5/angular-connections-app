"use strict";(self.webpackChunkconnections_app=self.webpackChunkconnections_app||[]).push([[550],{1550:(U,d,s)=>{s.r(d),s.d(d,{ConversationModule:()=>F});var a=s(6814),M=s(2296),O=s(2032),r=s(6223),c=s(5959),P=s(9947),p=s(8180),u=s(9397),_=s(6367),m=s(4851),h=s(4221);const x=(0,h.ZF)("conversationHistoryList"),v=(0,h.P1)(x,n=>n.conversationHistoryList),f=n=>(0,h.P1)(v,g=>g[n.conversationID]);var k=s(7790),y=s(3159),t=s(5879),b=s(9713),l=s(5683);function w(n,g){if(1&n&&(t.TgZ(0,"div",14)(1,"div",15)(2,"span",16),t._uU(3),t.ALo(4,"async"),t.qZA()(),t.TgZ(5,"span",17),t._uU(6),t.qZA(),t.TgZ(7,"div",18)(8,"span",19),t._uU(9),t.ALo(10,"date"),t.qZA()()()),2&n){const e=g.$implicit,o=t.oxw(2);t.Q6J("ngClass",o.isAuthorMessage(e)),t.xp6(3),t.Oqu(t.lcZ(4,4,o.store.select(o.selectUserById(e.authorID)))),t.xp6(3),t.Oqu(e.message),t.xp6(3),t.Oqu(t.xi3(10,6,e.createdAt,"short"))}}function A(n,g){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter your message"),t.qZA())}function I(n,g){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",2)(2,"button",3),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onUpdateButtonClick())}),t._uU(3," UPDATE CHAT MESSAGES "),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onDeleteConversationButtonClick())}),t._uU(5," DELETE CHAT "),t.qZA()(),t.TgZ(6,"div",5),t.YNc(7,w,11,9,"div",6),t.qZA(),t.TgZ(8,"div",7)(9,"form",8)(10,"mat-form-field",9)(11,"mat-label"),t._uU(12,"Message"),t.qZA(),t.YNc(13,A,2,0,"mat-error",1),t._UZ(14,"textarea",10,11),t.qZA()(),t.TgZ(16,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(15),C=t.oxw();return t.KtG(C.onSendNewMessageButtonClick(i.value))}),t._uU(17," SEND NEW MESSAGE "),t.qZA()(),t.TgZ(18,"a",13),t._uU(19,"RETURN TO THE MAIN PAGE"),t.qZA(),t.BQk()}if(2&n){const e=g.ngIf,o=t.oxw();t.xp6(7),t.Q6J("ngForOf",e.messages),t.xp6(2),t.Q6J("formGroup",o.chatForm),t.xp6(4),t.Q6J("ngIf",o.message.invalid),t.xp6(3),t.Q6J("disabled",o.chatForm.invalid),t.xp6(2),t.Q6J("routerLink",o.ProjectPages.Empty)}}const D=function(n){return{conversationID:n}};let Z=(()=>{class n{constructor(e,o,i,C){this.store=e,this.modalService=o,this.activatedRoute=i,this.fb=C,this.selectUserById=_.Ls,this.selectSpecificConversationById=f,this.ProjectPages=P.RQ,this.chatForm=this.fb.group({message:["",r.kI.required]}),this.authorUid=JSON.parse(localStorage.getItem("userObject")).uid,this.conversationID=this.activatedRoute.snapshot.paramMap.get("id")}ngOnInit(){this.synchronizeConversationMessages(),this.store.select(_.dq).pipe((0,p.q)(1)).subscribe(e=>{0===e.length&&(this.store.dispatch((0,k.I$)()),this.store.dispatch((0,y.op)()))})}get message(){return this.chatForm.get("message")}synchronizeConversationMessages(){const e=this.store.select(f({conversationID:this.conversationID}));e.pipe((0,p.q)(1),(0,u.b)(o=>{this.store.dispatch((0,m.QY)(o?{conversationID:this.conversationID,since:o.since}:{conversationID:this.conversationID,since:0}))})).subscribe(),this.conversationResponse$=e}onUpdateButtonClick(){this.synchronizeConversationMessages()}onDeleteConversationButtonClick(){this.modalService.openConfirmationDialog(this.conversationID,!1)}onSendNewMessageButtonClick(e){this.store.dispatch((0,m.az)({conversationMessage:{conversationID:this.conversationID,message:e}})),this.chatForm.reset(),setTimeout(()=>{this.synchronizeConversationMessages()},1500)}isAuthorMessage(e){return this.authorUid===e.authorID?"author-message":""}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(h.yh),t.Y36(b.Z),t.Y36(c.gz),t.Y36(r.qu))};static#n=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-conversation"]],decls:3,vars:5,consts:[[1,"main-container"],[4,"ngIf"],[1,"control-buttons"],["mat-raised-button","","color","primary",1,"update-button",3,"click"],["mat-raised-button","","color","warn",1,"delete-button",3,"click"],[1,"message-container"],["class","wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"form-wrapper"],[1,"chat-form",3,"formGroup"],[1,"message-form"],["matInput","","type","text","formControlName","message",1,"message-input"],["textInput",""],["mat-raised-button","","color","primary",1,"send-button",3,"disabled","click"],[1,"main-page-link",3,"routerLink"],[1,"wrapper",3,"ngClass"],[1,"author-wrapper"],[1,"author","item"],[1,"message","item"],[1,"created-at-wrapper"],[1,"created-at","item"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0),t.YNc(1,I,20,5,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,i.store.select(i.selectSpecificConversationById(t.VKq(3,D,i.conversationID))))))},dependencies:[a.mk,a.sg,a.O5,c.rH,M.lW,O.Nt,l.KE,l.hX,l.TO,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,a.Ov,a.uU],styles:[".light-theme   [_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.light-theme[_nghost-%COMP%]   .main-container[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .main-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:2rem}.light-theme[_nghost-%COMP%]   .control-buttons[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .control-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:90%;gap:1rem;align-self:center;margin-bottom:2rem}.light-theme[_nghost-%COMP%]   .update-button[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .update-button[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   .delete-button[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .delete-button[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   .send-button[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .send-button[_ngcontent-%COMP%]{font-family:Agency FB,serif;font-size:2.5rem}.light-theme[_nghost-%COMP%]   .message-container[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .message-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:90rem;background-color:#faebd7;padding:2rem;overflow:auto;height:50rem}.light-theme[_nghost-%COMP%]   .message-form[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .message-form[_ngcontent-%COMP%]{width:100%;align-self:center}.light-theme[_nghost-%COMP%]   .message-input[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .message-input[_ngcontent-%COMP%]{resize:none}.light-theme[_nghost-%COMP%]   .item-info[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .item-info[_ngcontent-%COMP%]{display:flex}.light-theme[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]{padding:1rem;align-self:flex-start;display:flex;flex-direction:column;align-items:center}.light-theme[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{align-self:flex-end}.light-theme[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{order:1}.light-theme[_nghost-%COMP%]   .author[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .author[_ngcontent-%COMP%]{font-family:Agency FB,serif;margin-right:1rem;font-weight:800;letter-spacing:1px;font-size:1.7rem}.light-theme[_nghost-%COMP%]   .message[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .message[_ngcontent-%COMP%]{display:block;min-width:10rem;max-width:700px;padding:14px 18px;margin:6px 8px;background-color:#6c8ea4;border-radius:0 16px 16px;border:1px solid #54788e;color:#fff;font-size:2rem}.light-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]{align-self:flex-end;display:flex;flex-direction:column}.light-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{font-size:2rem;min-width:60px;max-width:700px;padding:14px 18px;margin:6px 8px;background-color:#5b5377;border-radius:16px 16px 0;border:1px solid #443f56}.light-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{align-self:flex-end}.light-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{order:0}.light-theme[_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%]{margin-top:5rem;font-size:3rem;font-weight:800;text-decoration:none;color:red;transition:.7s;align-self:center;font-family:Agency FB,serif}.light-theme[_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%]:hover, .light-theme   [_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%]:hover{color:#000}.light-theme[_nghost-%COMP%]   .chat-form[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .chat-form[_ngcontent-%COMP%]{margin-top:2rem;display:flex}.light-theme[_nghost-%COMP%]   .created-at[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .created-at[_ngcontent-%COMP%]{color:#4f4f4f}.light-theme[_nghost-%COMP%]   .form-wrapper[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:center;width:90%}.dark-theme   [_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.dark-theme[_nghost-%COMP%]   .main-container[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .main-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:2rem}.dark-theme[_nghost-%COMP%]   .control-buttons[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .control-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:90%;gap:1rem;align-self:center;margin-bottom:2rem}.dark-theme[_nghost-%COMP%]   .update-button[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .update-button[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .delete-button[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .delete-button[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .send-button[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .send-button[_ngcontent-%COMP%]{font-family:Agency FB,serif;font-size:2.5rem}.dark-theme[_nghost-%COMP%]   .update-button[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .update-button[_ngcontent-%COMP%]{background-color:#fff!important;color:#000!important}.dark-theme[_nghost-%COMP%]   .send-button[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .send-button[_ngcontent-%COMP%]{background-color:#d3d3d3!important}.dark-theme[_nghost-%COMP%]   .message-container[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .message-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:90rem;background-color:#d3d3d3;padding:2rem;overflow:auto;height:50rem}.dark-theme[_nghost-%COMP%]   .message-form[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .message-form[_ngcontent-%COMP%]{width:100%;align-self:center}.dark-theme[_nghost-%COMP%]   .message-input[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .message-input[_ngcontent-%COMP%]{resize:none}.dark-theme[_nghost-%COMP%]   .item-info[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .item-info[_ngcontent-%COMP%]{display:flex}.dark-theme[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]{padding:1rem;align-self:flex-start;display:flex;flex-direction:column;align-items:center}.dark-theme[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{align-self:flex-end}.dark-theme[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{order:1}.dark-theme[_nghost-%COMP%]   .author[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .author[_ngcontent-%COMP%]{font-family:Agency FB,serif;margin-right:1rem;font-weight:800;letter-spacing:1px;font-size:1.7rem}.dark-theme[_nghost-%COMP%]   .message[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .message[_ngcontent-%COMP%]{display:block;min-width:10rem;max-width:700px;padding:14px 18px;margin:6px 8px;background-color:#3592bd;border-radius:0 16px 16px;border:1px solid #3592bd;color:#fff;font-size:2rem}.dark-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]{align-self:flex-end;display:flex;flex-direction:column}.dark-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{font-size:2rem;min-width:60px;max-width:700px;padding:14px 18px;margin:6px 8px;background-color:#5234c0;border-radius:16px 16px 0;border:1px solid #5234c0}.dark-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{align-self:flex-end}.dark-theme[_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .author-message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{order:0}.dark-theme[_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%]{margin-top:5rem;font-size:3rem;font-weight:800;text-decoration:none;color:#fff;transition:.7s;align-self:center;font-family:Agency FB,serif}.dark-theme[_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%]:hover, .dark-theme   [_nghost-%COMP%]   .main-page-link[_ngcontent-%COMP%]:hover{color:#5b5377}.dark-theme[_nghost-%COMP%]   .chat-form[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .chat-form[_ngcontent-%COMP%]{margin-top:2rem;display:flex}.dark-theme[_nghost-%COMP%]   .created-at[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .created-at[_ngcontent-%COMP%]{color:#4f4f4f}.dark-theme[_nghost-%COMP%]   .form-wrapper[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:center;width:90%}"],changeDetection:0})}return n})();var T=s(6500);const B=[{path:`${P.RQ.ConversationId}`,component:Z,canActivate:[T.p]}];let z=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#n=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(B),c.Bz]})}return n})(),F=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#n=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[a.ez,z,M.ot,O.c,r.UX]})}return n})()}}]);